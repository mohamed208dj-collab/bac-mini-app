<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BAC PLUS | Ù…Ø±ÙƒØ² Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    
    <style>
        * { -webkit-touch-callout: none; -webkit-user-select: none; user-select: none; box-sizing: border-box; }
        body { font-family: 'Cairo', sans-serif; background-color: #020617; color: #fff; padding: 15px; overflow-x: hidden; }

        /* Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© */
        .nav-back { position: absolute; top: 20px; right: 20px; cursor: pointer; z-index: 100; transition: 0.3s; text-decoration: none; }
        .nav-back svg { width: 28px; height: 28px; color: #64748b; }
        .nav-back:hover svg { color: #3b82f6; }

        /* Ø§Ù„Ø¹Ø¬Ù„Ø© - Ø§Ù„ØªÙˆÙ‚ÙŠØª Ù„Ø§Ø²Ù… ÙŠÙˆØ§ÙÙ‚ Ø§Ù„Ù€ setTimeout */
        #wheel { transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1); filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.2)); }
        .pointer { position: absolute; top: -15px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 25px solid #ef4444; z-index: 50; filter: drop-shadow(0 2px 5px rgba(0,0,0,0.5)); }

        .quest-item { background: rgba(30, 41, 59, 0.5); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 20px; padding: 14px; margin-bottom: 10px; transition: 0.3s; cursor: pointer; }
        .quest-item.completed { opacity: 0.3; pointer-events: none; border-color: #10b981; filter: grayscale(1); }

        #customAlert { display: none; position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 200; padding: 12px 25px; border-radius: 15px; font-weight: 900; font-size: 13px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

        #taskModal { display: none; background: rgba(2, 6, 23, 0.98); backdrop-filter: blur(20px); z-index: 100; }
        .opt-btn { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); padding: 14px; border-radius: 15px; width: 100%; text-align: right; font-weight: 700; margin-bottom: 8px; transition: 0.2s; color: white; }
    </style>
</head>
<body class="pb-10">

    <div id="customAlert"></div>

    <a href="home.html" class="nav-back">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
            <path d="M15 19l-7-7 7-7"/>
        </svg>
    </a>

    <div class="flex items-center justify-between mb-8 pt-4 px-2">
        <div class="flex items-center gap-2 bg-blue-500/10 border border-blue-500/20 px-5 py-2 rounded-2xl shadow-inner">
            <span class="text-yellow-400">â­</span>
            <span id="score" class="font-black text-xl">0</span>
        </div>
        <div class="text-left">
            <h1 class="text-lg font-black italic uppercase">BAC <span class="text-blue-500">Plus</span></h1>
            <p class="text-[8px] text-gray-500 font-bold tracking-widest">REWARDS CENTER</p>
        </div>
    </div>

    <div class="text-center mb-10">
        <div class="relative w-64 h-64 mx-auto mb-8">
            <div class="pointer"></div>
            <canvas id="wheel" width="256" height="256"></canvas>
        </div>
        <button id="spinBtn" onclick="spin()" class="bg-blue-600 px-10 py-4 rounded-2xl font-black text-xs shadow-lg active:scale-95 transition-all border-b-4 border-blue-800">ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¹Ø¬Ù„Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠ</button>
    </div>

    <div class="px-2">
        <h3 class="text-[10px] font-black opacity-50 mb-4 tracking-[0.2em] uppercase flex justify-between items-center">
            <span>Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</span>
            <span class="text-blue-500 bg-blue-500/10 px-2 py-1 rounded-lg">7 Ù…Ù‡Ø§Ù…</span>
        </h3>
        <div id="tasksList"></div>
    </div>

    <div id="taskModal" class="fixed inset-0 flex items-center justify-center p-6">
        <div class="w-full max-w-sm bg-slate-900 border border-white/10 p-8 rounded-[2.5rem] text-center shadow-2xl">
            <h4 id="mSubject" class="text-[10px] font-black text-blue-500 mb-2 uppercase tracking-widest">--</h4>
            <p id="mQuestion" class="text-sm font-bold mb-6 leading-relaxed">--</p>
            <div id="mOptions"></div>
        </div>
    </div>

    <script>
        let points = parseInt(localStorage.getItem('userPoints')) || 0;
        document.getElementById('score').innerText = points;

        const canvas = document.getElementById('wheel');
        const ctx = canvas.getContext('2d');
        const sectors = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
        const colors = ['#1e293b', '#3b82f6', '#1e293b', '#3b82f6', '#1e293b', '#3b82f6', '#1e293b', '#3b82f6', '#1e293b', '#ef4444'];

        function drawWheel() {
            const arc = (2 * Math.PI) / sectors.length;
            sectors.forEach((s, i) => {
                ctx.beginPath(); ctx.fillStyle = colors[i]; ctx.moveTo(128, 128);
                ctx.arc(128, 128, 125, i*arc, (i+1)*arc); ctx.fill();
                ctx.save(); ctx.translate(128, 128); ctx.rotate(i*arc + arc/2);
                ctx.textAlign="right"; ctx.fillStyle="#fff"; ctx.font="900 16px Cairo";
                ctx.fillText(s, 110, 8); ctx.restore();
            });
        }

        function spin() {
            if(localStorage.getItem('lastSpin') === new Date().toDateString()) {
                showAlert("Ø¹Ø¯ ØºØ¯Ø§Ù‹ Ù„Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø«Ø§Ù†ÙŠØ©!", "#ef4444");
                return;
            }
            
            const btn = document.getElementById('spinBtn');
            btn.disabled = true;
            
            const extraDeg = Math.floor(Math.random() * 360);
            const totalDeg = 3600 + extraDeg; // 10 Ø¯ÙˆØ±Ø§Øª + Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
            
            canvas.style.transform = `rotate(${totalDeg}deg)`;

            setTimeout(() => {
                // Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„ØªÙ‚Ù†ÙŠ Ù„Ù„Ø­Ø³Ø§Ø¨:
                const actualDeg = extraDeg % 360;
                const sectorAngle = 360 / sectors.length;
                // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ§Ø¦Ø² Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø³Ù‡Ù… (Top = 270 deg)
                const index = Math.floor(((360 - actualDeg + 270) % 360) / sectorAngle);
                const winValue = sectors[index];

                addPoints(winValue);
                localStorage.setItem('lastSpin', new Date().toDateString());
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                showAlert(`Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª ${winValue} Ù†Ù‚Ø·Ø©`, "#10b981");
                btn.innerText = "ØªÙ…Øª Ø§Ù„Ù„ÙØ© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©";
            }, 4000);
        }

        const bank = [
            {id:1, s:"Ø¹Ø±Ø¨ÙŠØ©", q:"Ù…Ø§ Ù‡Ùˆ Ø¬Ù…Ø¹ 'Ø­Ù„ÙŠØ¨'ØŸ", o:["Ø£Ø­Ù„Ø¨Ø©", "Ù„Ø§ ÙŠÙˆØ¬Ø¯", "Ø­Ù„Ø¨Ø§Øª"], a:1},
            {id:2, s:"Ø±ÙŠØ§Ø¶ÙŠØ§Øª", q:"Ù…Ø´ØªÙ‚ xÂ² Ù‡Ùˆ:", o:["x", "2x", "1"], a:1},
            {id:3, s:"Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ", q:"Opposite of 'Fast'?", o:["Slow", "Quick", "Smart"], a:0},
            {id:4, s:"Ø¥Ø³Ù„Ø§Ù…ÙŠØ©", q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø³ÙˆØ± Ø§Ù„Ù‚Ø±Ø¢Ù†ØŸ", o:["110", "114", "120"], a:1},
            {id:5, s:"ØªØ§Ø±ÙŠØ®", q:"Ø§Ù†Ø¯Ù„Ø§Ø¹ Ø§Ù„Ø«ÙˆØ±Ø© Ø§Ù„ØªØ­Ø±ÙŠØ±ÙŠØ© ÙƒØ§Ù† ÙÙŠ:", o:["1954", "1962", "1945"], a:0},
            {id:6, s:"Ø¹Ù„ÙˆÙ…", q:"Ù…Ù‚Ø± Ø§Ù„ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø¶ÙˆØ¦ÙŠ Ù‡Ùˆ:", o:["Ø§Ù„Ø¬Ø°ÙˆØ±", "Ø§Ù„ØµØ§Ù†Ø¹Ø§Øª Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡", "Ø§Ù„Ù†ÙˆØ§Ø©"], a:1},
            {id:7, s:"ÙØ±Ù†Ø³ÙŠØ©", q:"Feminin de 'Beau'?", o:["Belle", "Bon", "BeautÃ©"], a:0}
        ];

        function loadTasks() {
            const list = document.getElementById('tasksList');
            list.innerHTML = '';
            bank.forEach(t => {
                const done = localStorage.getItem(`task_${t.id}_${new Date().toDateString()}`);
                list.innerHTML += `
                    <div class="quest-item ${done ? 'completed' : ''}" onclick="openTask(${t.id})">
                        <div class="flex justify-between items-center">
                            <div><h4 class="text-xs font-black">Ø³Ø¤Ø§Ù„ ÙÙŠ Ø§Ù„Ù€ ${t.s}</h4><p class="text-[9px] text-gray-500">Ø£Ø¬Ø¨ Ù„ØªØ±Ø¨Ø­ Ù†Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø©</p></div>
                            <span class="text-blue-400 font-black">${done ? 'âœ“' : '+1'}</span>
                        </div>
                    </div>`;
            });
        }

        function openTask(id) {
            const t = bank.find(x => x.id === id);
            document.getElementById('mSubject').innerText = t.s;
            document.getElementById('mQuestion').innerText = t.q;
            const opts = document.getElementById('mOptions');
            opts.innerHTML = '';
            t.o.forEach((opt, i) => {
                opts.innerHTML += `<button onclick="checkTask(${id}, ${i}, ${t.a})" class="opt-btn">${opt}</button>`;
            });
            document.getElementById('taskModal').style.display = 'flex';
        }

        function checkTask(id, chosen, correct) {
            document.getElementById('taskModal').style.display = 'none';
            if(chosen === correct) {
                addPoints(1);
                localStorage.setItem(`task_${id}_${new Date().toDateString()}`, true);
                showAlert("ØµØ­ÙŠØ­! +1 Ù†Ù‚Ø·Ø© ğŸŒŸ", "#10b981");
            } else {
                showAlert("Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹", "#ef4444");
            }
            loadTasks();
        }

        function addPoints(val) {
            points += val;
            localStorage.setItem('userPoints', points);
            document.getElementById('score').innerText = points;
        }

        function showAlert(msg, color) {
            const alert = document.getElementById('customAlert');
            alert.innerText = msg; alert.style.backgroundColor = color; alert.style.display = 'block';
            setTimeout(() => alert.style.display = 'none', 3000);
        }

        drawWheel(); loadTasks();
    </script>
</body>
</html>
