<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BAC PLUS | Ù…Ø±ÙƒØ² Ø§Ù„Ù…ÙƒØ§ÙØ¢Øª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    
    <style>
        * { -webkit-touch-callout: none; -webkit-user-select: none; user-select: none; box-sizing: border-box; }
        body { 
            font-family: 'Cairo', sans-serif; 
            background-color: #020617; 
            color: #fff; 
            padding: 20px; 
            overflow-x: hidden;
            background-image: radial-gradient(circle at top right, rgba(59, 130, 246, 0.1), transparent);
        }

        /* Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ø§Ù„Ø¹Ø§Ø¦Ù… */
        .floating-back { 
            position: fixed; 
            bottom: 30px; 
            right: 30px; 
            width: 60px; 
            height: 60px; 
            background: #2563eb; 
            border-radius: 20px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.4); 
            z-index: 1000; 
            transition: 0.3s;
            text-decoration: none;
        }
        .floating-back:active { transform: scale(0.85); }

        /* Ø§Ù„Ø¹Ø¬Ù„Ø© */
        #wheel { transition: transform 4s cubic-bezier(0.15, 0, 0.15, 1); filter: drop-shadow(0 0 30px rgba(59, 130, 246, 0.3)); }
        .wheel-container { position: relative; padding: 10px; border-radius: 50%; background: rgba(255,255,255,0.03); border: 2px solid rgba(255,255,255,0.05); }
        .pointer { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 25px solid #ef4444; z-index: 50; }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù‡Ø§Ù… */
        .quest-card { 
            background: rgba(255, 255, 255, 0.03); 
            border: 1px solid rgba(255, 255, 255, 0.08); 
            border-radius: 24px; 
            padding: 16px; 
            margin-bottom: 12px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            transition: 0.3s;
            position: relative;
            overflow: hidden;
        }
        .quest-card::before { content: ''; position: absolute; left: 0; top: 0; width: 4px; height: 100%; background: var(--m-color); }
        .quest-card.completed { opacity: 0.4; filter: grayscale(0.8); pointer-events: none; }

        #customAlert { display: none; position: fixed; top: 30px; left: 50%; transform: translateX(-50%); z-index: 2000; padding: 15px 30px; border-radius: 20px; font-weight: 900; box-shadow: 0 15px 40px rgba(0,0,0,0.6); animation: bounceIn 0.5s ease; }
        @keyframes bounceIn { from { opacity: 0; transform: translate(-50%, -50px); } }

        #taskModal { display: none; background: rgba(2, 6, 23, 0.95); backdrop-filter: blur(15px); z-index: 5000; }
    </style>
</head>
<body class="pb-28">

    <div id="customAlert"></div>

    <a href="home.html" class="floating-back">
        <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
    </a>

    <div class="flex items-center justify-between mb-10 pt-4 px-2">
        <div class="bg-blue-600/20 border border-blue-500/30 px-6 py-3 rounded-2xl flex items-center gap-3">
            <span class="text-2xl">â­</span>
            <span id="score" class="font-black text-2xl text-blue-400">0</span>
        </div>
        <div class="text-left font-black italic">BAC <span class="text-blue-500">Plus</span></div>
    </div>

    <div class="text-center mb-12">
        <div class="wheel-container w-64 h-64 mx-auto mb-8 flex items-center justify-center">
            <div class="pointer"></div>
            <canvas id="wheel" width="260" height="260"></canvas>
        </div>
        <button id="spinBtn" onclick="spin()" class="bg-blue-600 w-full max-w-xs py-4 rounded-[2rem] font-black text-sm border-b-4 border-blue-800 active:border-0 transition-all">ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¹Ø¬Ù„Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠ</button>
    </div>

    <div class="px-1">
        <h3 class="text-[11px] font-black text-gray-500 mb-5 tracking-[0.2em] uppercase">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</h3>
        <div id="tasksList"></div>
    </div>

    <div id="taskModal" class="fixed inset-0 flex items-center justify-center p-6">
        <div class="w-full max-w-sm bg-slate-900 border border-white/10 p-10 rounded-[3rem] text-center shadow-2xl">
            <h4 id="mSubject" class="text-xs font-black text-blue-500 mb-2 uppercase tracking-widest">--</h4>
            <p id="mQuestion" class="text-lg font-bold mb-8">--</p>
            <div id="mOptions" class="space-y-3"></div>
        </div>
    </div>

    <script>
        let points = parseInt(localStorage.getItem('userPoints')) || 0;
        document.getElementById('score').innerText = points;

        // Ø±Ø³Ù… Ø§Ù„Ø¹Ø¬Ù„Ø© (Ù†ÙØ³ Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø³Ø§Ø¨Ù‚)
        const canvas = document.getElementById('wheel');
        const ctx = canvas.getContext('2d');
        const sectors = [1, 5, 2, 10, 3, 5, 4, 1, 2, 5];
        const colors = ['#1e293b', '#3b82f6', '#1e293b', '#3b82f6', '#1e293b', '#3b82f6', '#1e293b', '#3b82f6', '#1e293b', '#ef4444'];
        function drawWheel() {
            const arc = (2 * Math.PI) / sectors.length;
            sectors.forEach((s, i) => {
                ctx.beginPath(); ctx.fillStyle = colors[i]; ctx.moveTo(130, 130);
                ctx.arc(130, 130, 125, i*arc, (i+1)*arc); ctx.fill();
                ctx.save(); ctx.translate(130, 130); ctx.rotate(i*arc + arc/2);
                ctx.textAlign="right"; ctx.fillStyle="#fff"; ctx.font="900 18px Cairo";
                ctx.fillText(s, 110, 8); ctx.restore();
            });
        }

        function spin() {
            if(localStorage.getItem('lastSpin') === new Date().toDateString()) {
                showAlert("Ø¹Ø¯ ØºØ¯Ø§Ù‹ Ù„Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø«Ø§Ù†ÙŠØ©!", "#ef4444"); return;
            }
            const btn = document.getElementById('spinBtn'); btn.disabled = true;
            const extraDeg = Math.floor(Math.random() * 360);
            const totalDeg = 3600 + extraDeg;
            canvas.style.transform = `rotate(${totalDeg}deg)`;
            setTimeout(() => {
                const actualDeg = extraDeg % 360;
                const index = Math.floor(((360 - actualDeg + 270) % 360) / (360 / sectors.length));
                addPoints(sectors[index]);
                localStorage.setItem('lastSpin', new Date().toDateString());
                confetti({ particleCount: 150 });
                showAlert(`Ø±Ø¨Ø­Øª ${sectors[index]} Ù†Ù‚Ø·Ø©! âœ¨`, "#10b981");
                btn.innerText = "Ø¹Ø¯ ØºØ¯Ø§Ù‹";
            }, 4000);
        }

        const bank = [
            {id:1, s:"Ø¹Ø±Ø¨ÙŠØ©", q:"Ù…Ø§ Ù‡Ùˆ Ø¬Ù…Ø¹ 'Ø­Ù„ÙŠØ¨'ØŸ", o:["Ø£Ø­Ù„Ø¨Ø©", "Ù„Ø§ ÙŠÙˆØ¬Ø¯", "Ø­Ù„Ø¨Ø§Øª"], a:1, c:"#ef4444", i:"ğŸ“–"},
            {id:2, s:"Ø±ÙŠØ§Ø¶ÙŠØ§Øª", q:"Ù…Ø´ØªÙ‚ xÂ² Ù‡Ùˆ:", o:["x", "2x", "1"], a:1, c:"#3b82f6", i:"ğŸ“"},
            {id:3, s:"Ø¥Ø³Ù„Ø§Ù…ÙŠØ©", q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø³ÙˆØ± Ø§Ù„Ù‚Ø±Ø¢Ù†ØŸ", o:["110", "114", "120"], a:1, c:"#10b981", i:"ğŸŒ™"},
            {id:4, s:"ØªØ§Ø±ÙŠØ®", q:"Ø§Ù†Ø¯Ù„Ø§Ø¹ Ø§Ù„Ø«ÙˆØ±Ø© Ø§Ù„ØªØ­Ø±ÙŠØ±ÙŠØ©:", o:["1954", "1962", "1945"], a:0, c:"#8b5cf6", i:"ğŸ‡©ğŸ‡¿"}
        ];

        function loadTasks() {
            const list = document.getElementById('tasksList');
            list.innerHTML = '';
            bank.forEach(t => {
                const tried = localStorage.getItem(`task_tried_${t.id}_${new Date().toDateString()}`);
                list.innerHTML += `
                    <div class="quest-card ${tried ? 'completed' : ''}" style="--m-color: ${t.c}" onclick="openTask(${t.id})">
                        <div class="flex items-center gap-4">
                            <div class="w-10 h-10 flex items-center justify-center text-xl">${t.i}</div>
                            <div><h4 class="text-sm font-black">ØªØ­Ø¯ÙŠ Ø§Ù„Ù€ ${t.s}</h4><p class="text-[9px] text-gray-500">Ø§Ø±Ø¨Ø­ +1 Ù†Ù‚Ø·Ø©</p></div>
                        </div>
                        <div class="text-blue-500 font-black">${tried ? 'ØªÙ…Øª' : '+1'}</div>
                    </div>`;
            });
        }

        function openTask(id) {
            const t = bank.find(x => x.id === id);
            document.getElementById('mSubject').innerText = t.s;
            document.getElementById('mQuestion').innerText = t.q;
            const opts = document.getElementById('mOptions');
            opts.innerHTML = '';
            t.o.forEach((opt, i) => {
                opts.innerHTML += `<button onclick="checkTask(${id}, ${i}, ${t.a})" class="w-full bg-white/5 py-4 rounded-2xl font-bold active:bg-blue-600 transition"> ${opt} </button>`;
            });
            document.getElementById('taskModal').style.display = 'flex';
        }

        function checkTask(id, chosen, correct) {
            document.getElementById('taskModal').style.display = 'none';
            
            // ØªØ³Ø¬ÙŠÙ„ Ø£Ù† Ø§Ù„Ø·Ø§Ù„Ø¨ "Ø­Ø§ÙˆÙ„" ÙÙŠ Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„ÙŠÙˆÙ…ØŒ Ø³ÙˆØ§Ø¡ ÙƒØ§Ù† ØµØ­ Ø£Ùˆ Ø®Ø·Ø£
            localStorage.setItem(`task_tried_${id}_${new Date().toDateString()}`, "true");

            if(chosen === correct) {
                addPoints(1);
                confetti({ particleCount: 50 });
                showAlert("Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! +1 ğŸŒŸ", "#10b981");
            } else {
                showAlert("Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! Ø­Ø¸Ø§Ù‹ Ø£ÙˆÙØ± ØºØ¯Ø§Ù‹ âŒ", "#ef4444");
            }
            loadTasks();
        }

        function addPoints(val) {
            points += val;
            localStorage.setItem('userPoints', points);
            document.getElementById('score').innerText = points;
        }

        function showAlert(msg, color) {
            const alert = document.getElementById('customAlert');
            alert.innerText = msg; alert.style.backgroundColor = color; alert.style.display = 'block';
            setTimeout(() => alert.style.display = 'none', 3000);
        }

        drawWheel(); loadTasks();
    </script>
</body>
</html>
