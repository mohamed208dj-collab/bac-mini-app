<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BAC PLUS | الحاسبة الشاملة</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        * { -webkit-touch-callout: none; -webkit-user-select: none; user-select: none; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Cairo', sans-serif; background-color: #020617; color: #f8fafc; margin: 0; padding: 10px; }

        /* ستايل الجدول الاحترافي */
        .main-table { width: 100%; border-collapse: separate; border-spacing: 0 8px; }
        .table-head th { padding: 12px 5px; font-size: 10px; color: #64748b; text-transform: uppercase; font-weight: 900; }
        
        .row-card { background: rgba(30, 41, 59, 0.5); backdrop-filter: blur(10px); transition: 0.3s; }
        .row-card td { padding: 12px 5px; border-top: 1px solid rgba(255,255,255,0.05); border-bottom: 1px solid rgba(255,255,255,0.05); }
        .row-card td:first-child { border-right: 4px solid var(--br-color); border-top-right-radius: 12px; border-bottom-right-radius: 12px; }
        .row-card td:last-child { border-top-left-radius: 12px; border-bottom-left-radius: 12px; }

        /* ستايل الإدخال */
        .cell-input {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(255,255,255,0.1);
            color: #fff;
            width: 45px;
            height: 35px;
            text-align: center;
            border-radius: 8px;
            font-weight: 900;
            font-size: 13px;
            outline: none;
            -webkit-user-select: text !important;
        }
        .cell-input:focus { border-color: var(--br-color); box-shadow: 0 0 10px var(--br-shadow); }

        .shoba-btn.active { background: var(--br-color); color: white; box-shadow: 0 8px 15px var(--br-shadow); }

        .sticky-footer {
            position: fixed; bottom: 0; left: 0; right: 0;
            background: rgba(2, 6, 23, 0.9);
            backdrop-filter: blur(15px);
            padding: 15px; border-top: 1px solid rgba(255,255,255,0.1);
            z-index: 100;
        }

        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="pb-32">

    <div class="flex items-center justify-between p-4 mb-4">
        <a href="home.html" class="w-10 h-10 flex items-center justify-center bg-white/5 rounded-full border border-white/10">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
        </a>
        <h1 class="text-lg font-black italic">الحساب <span class="text-blue-500">الفصلي</span></h1>
        <div class="w-10"></div>
    </div>

    <div class="flex overflow-x-auto gap-2 mb-6 no-scrollbar px-2">
        <button onclick="render('science', '#3b82f6')" id="btn-science" class="shoba-btn px-5 py-2.5 rounded-xl border border-white/5 bg-white/5 font-black text-[10px] whitespace-nowrap">علوم تجريبية</button>
        <button onclick="render('math', '#ef4444')" id="btn-math" class="shoba-btn px-5 py-2.5 rounded-xl border border-white/5 bg-white/5 font-black text-[10px] whitespace-nowrap">رياضيات</button>
        <button onclick="render('tech', '#f97316')" id="btn-tech" class="shoba-btn px-5 py-2.5 rounded-xl border border-white/5 bg-white/5 font-black text-[10px] whitespace-nowrap">تقني رياضي</button>
        <button onclick="render('adab', '#a855f7')" id="btn-adab" class="shoba-btn px-5 py-2.5 rounded-xl border border-white/5 bg-white/5 font-black text-[10px] whitespace-nowrap">أدب وفلسفة</button>
        <button onclick="render('lang', '#10b981')" id="btn-lang" class="shoba-btn px-5 py-2.5 rounded-xl border border-white/5 bg-white/5 font-black text-[10px] whitespace-nowrap">لغات أجنبية</button>
        <button onclick="render('gestion', '#facc15')" id="btn-gestion" class="shoba-btn px-5 py-2.5 rounded-xl border border-white/5 bg-white/5 font-black text-[10px] whitespace-nowrap">تسيير واقتصاد</button>
    </div>

    <div class="px-2 overflow-x-auto">
        <table class="main-table">
            <thead class="table-head">
                <tr>
                    <th class="text-right">المادة</th>
                    <th>تقويم</th>
                    <th>فرض</th>
                    <th>اختبار</th>
                    <th>معدل</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>
    </div>

    <div class="sticky-footer">
        <div class="flex justify-between items-center max-w-md mx-auto">
            <div>
                <p class="text-[8px] font-black opacity-40 uppercase tracking-widest">المعدل العام</p>
                <div class="flex items-baseline gap-1">
                    <span id="finalGpa" class="text-4xl font-black italic">00.00</span>
                    <span id="statusLabel" class="text-[9px] font-bold text-gray-500 uppercase">--</span>
                </div>
            </div>
            <div id="resultCircle" class="w-12 h-12 rounded-full border-4 border-white/10 flex items-center justify-center font-black text-[10px]">0%</div>
        </div>
    </div>

    <script>
        const db = {
            science: {c:'#3b82f6', s:'rgba(59,130,246,0.3)', m:[{n:"علوم",c:6},{n:"فيزياء",c:5},{n:"رياضيات",c:5},{n:"عربية",c:3},{n:"اجتماعيات",c:2},{n:"فرنسية",c:2},{n:"إنجليزية",c:2},{n:"إسلامية",c:2},{n:"فلسفة",c:2},{n:"رياضة",c:1}]},
            math: {c:'#ef4444', s:'rgba(239,68,68,0.3)', m:[{n:"رياضيات",c:7},{n:"فيزياء",c:6},{n:"عربية",c:3},{n:"علوم",c:2},{n:"اجتماعيات",c:2},{n:"فلسفة",c:2},{n:"فرنسية",c:2},{n:"إنجليزية",c:2},{n:"إسلامية",c:2},{n:"رياضة",c:1}]},
            tech: {c:'#f97316', s:'rgba(249,115,22,0.3)', m:[{n:"هندسة",c:7},{n:"رياضيات",c:6},{n:"فيزياء",c:6},{n:"عربية",c:3},{n:"اجتماعيات",c:2},{n:"فلسفة",c:2},{n:"فرنسية",c:2},{n:"إنجليزية",c:2},{n:"إسلامية",c:2},{n:"رياضة",c:1}]},
            adab: {c:'#a855f7', s:'rgba(168,85,247,0.3)', m:[{n:"فلسفة",c:6},{n:"عربية",c:6},{n:"اجتماعيات",c:4},{n:"فرنسية",c:3},{n:"إنجليزية",c:3},{n:"إسلامية",c:2},{n:"رياضيات",c:2},{n:"رياضة",c:1}]},
            lang: {c:'#10b981', s:'rgba(16,185,129,0.3)', m:[{n:"عربية",c:5},{n:"فرنسية",c:4},{n:"إنجليزية",c:5},{n:"لغة 3",c:5},{n:"اجتماعيات",c:2},{n:"فلسفة",c:2},{n:"رياضيات",c:2},{n:"إسلامية",c:2},{n:"رياضة",c:1}]},
            gestion: {c:'#facc15', s:'rgba(250,204,21,0.3)', m:[{n:"محاسبة",c:6},{n:"اقتصاد",c:5},{n:"رياضيات",c:5},{n:"قانون",c:2},{n:"عربية",c:3},{n:"اجتماعيات",c:4},{n:"فرنسية",c:2},{n:"إنجليزية",c:2},{n:"فلسفة",c:2},{n:"إسلامية",c:2},{n:"رياضة",c:1}]}
        };

        function render(key, color) {
            document.documentElement.style.setProperty('--br-color', color);
            document.documentElement.style.setProperty('--br-shadow', db[key].s);
            document.querySelectorAll('.shoba-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('btn-'+key).classList.add('active');

            const body = document.getElementById('tableBody');
            body.innerHTML = '';
            db[key].m.forEach((s, i) => {
                body.innerHTML += `
                    <tr class="row-card">
                        <td class="text-right pr-3 font-bold text-xs">${s.n} <small class="opacity-40">x${s.c}</small></td>
                        <td class="text-center"><input type="number" oninput="v(this);calc();" class="cell-input t-in" data-c="${s.c}" placeholder="-"></td>
                        <td class="text-center"><input type="number" oninput="v(this);calc();" class="cell-input f-in" placeholder="-"></td>
                        <td class="text-center"><input type="number" oninput="v(this);calc();" class="cell-input x-in" placeholder="-"></td>
                        <td class="text-center font-black text-xs text-blue-400 sub-avg">0.00</td>
                    </tr>`;
            });
            calc();
        }

        function v(el) { if(parseFloat(el.value)>20) el.value=20; if(parseFloat(el.value)<0) el.value=0; }

        function calc() {
            let sumPts = 0, sumCfs = 0;
            const rows = document.querySelectorAll('.row-card');
            rows.forEach(row => {
                const t = parseFloat(row.querySelector('.t-in').value) || 0;
                const f = parseFloat(row.querySelector('.f-in').value) || 0;
                const x = parseFloat(row.querySelector('.x-in').value) || 0;
                const c = parseFloat(row.querySelector('.t-in').dataset.c);
                
                let m = (((t + f) / 2) + (x * 2)) / 3;
                row.querySelector('.sub-avg').innerText = m.toFixed(2);
                sumPts += (m * c); sumCfs += c;
            });

            const gpa = sumPts / sumCfs;
            const finalGpaEl = document.getElementById('finalGpa');
            finalGpaEl.innerText = gpa.toFixed(2);

            const label = document.getElementById('statusLabel');
            const circle = document.getElementById('resultCircle');
            
            if(gpa >= 10) { 
                finalGpaEl.style.color = "#10b981"; 
                label.innerText = "ناجح ✅";
                circle.style.borderColor = "#10b981";
            } else { 
                finalGpaEl.style.color = "#ef4444"; 
                label.innerText = "راسب ❌";
                circle.style.borderColor = "#ef4444";
            }
            circle.innerText = Math.round((gpa/20)*100) + "%";
        }

        window.onload = () => render('science', '#3b82f6');
    </script>
</body>
</html>
